import mysql.connector
from dotenv import load_dotenv
import os

# Establishing a connection with the MySQL database and running the query generated by the Gemini model
def db_chain(query):
    connection = mysql.connector.connect(
        host = os.getenv("db_host"),
        database = os.getenv("db_name"),
        user = os.getenv("db_user"),
        password = os.getenv("db_password")
    )
    # Create a cursor object
    cursor = connection.cursor()

    # Execute the SQL query generated by the Gemini LLM
    cursor.execute(query)

    # Fetch the result
    rows = cursor.fetchall()

    cursor.close()
    connection.close()
    return rows